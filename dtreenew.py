from meta_file import load_data
import numpy as np
from numpy import array
from sklearn import tree
import graphviz
data=load_data()
import sys  
import collections
reload(sys)  
sys.setdefaultencoding('utf8')

#print data.feature_names
#print data.target_names
#print data.data[0]
#print data.target[0]
#print data.target
#arrfeatures = array(data.feature_names)
#arrtarget_names = array(data.target_names)

clf = tree.DecisionTreeClassifier()

clf.fit(data.data, list(data.target))
#print clf.predict(data.data_test)
from sklearn.externals.six import StringIO
import pydotplus
dot_data = StringIO() 
tree.export_graphviz(clf, out_file=dot_data, 
                         feature_names=data.feature_names,  
                         class_names=data.target_names,  
                         filled=True, rounded=True,  
                         impurity=True)  
#print dot_data
#edges = collections.defaultdict(list)

graph=pydotplus.graph_from_dot_data(dot_data.getvalue())
#graph = graphviz.Source(dot_data)  

graph.write_png("dtree.png")
#print graph
