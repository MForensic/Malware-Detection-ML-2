import re
import pandas as pd
with open("eventhooks.txt") as s:
	
	i=0
	a=[]
	for line in s:
		if " Process:" in line:
			a.append(line.split()[-1])
			#	if word=="Process":
		#	a.append(word[(len(word)-1)])	
		#	print(a[i])
		#	print (i)
		#	i=i+1				# Extract apihooked process ID's
#b= list((set(a)))	
#print (b)
file_name="EVENTHOOKS.xlsx"
xl_workbook = pd.ExcelFile(file_name)  # Load the excel workbook
df = xl_workbook.parse('Sheet')  # Parse the sheet into a dataframe
pl=list(df['PID'])


for j in pl:
		
	row=df.loc[df['PID']==int(j)].index[0]
	col=df.columns.get_loc("EVENTHOOKS")                               # Mark the respective rows with 0
    	df.iat[row,col]=0


#print (a)
for i in a:
	#	print(i)
	row=df.loc[df['PID']==int(i)].index[0]
	col=df.columns.get_loc("EVENTHOOKS")				# Mark the respective row of those infected process in xlsx file with 1#
	df.iat[row,col]=1 
 


#print(rl)
#print(pl)
writer = pd.ExcelWriter('EVENTHOOKS.xlsx')
df.to_excel(writer,'Sheet')
writer.save()
