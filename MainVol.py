#import subprocess
import os
import sys
#//pathname = os.path.dirname(sys.arg[1])
#abspath = os.path.abspath({1})        
#subprocess.call('./vol.py', '-f', '/root/m/evilprofessor.vmem', 'imageinfo', '--output=sqlite', '--output-file=evil.sqlite', shell=True)
#subprocess.Popen("python3 /root/volatility/vol.py -f /root/m/evilprofessor.vmem imageinfo --output=sqlite --output-file=evil.sqlite") 
#subprocess.Popen(["/root/volatility/vol.py"], "-f" , "/root/m/evilprofessor.vmem",  "imageinfo", "--output=sqlite", "--output-file=evil.sqlite"])

#!/usr/local/bin/python3.1
import subprocess
#oper = ['hivelist', 'pstree', 'pslist', 'cmdscan', 'imageinfo', 'svcscan', 'symlinkscan']
oper = ['psxview','malfind','eventhooks','apihooks','messagehooks']
#mem = input("Memory Dump File: ")
mem=sys.argv[1]
for x in oper:
 if x!="psxview":
  command = ("/root/volatility/vol.py " + x + " -f "+mem+" --output-file=" +x+mem+".text " " --output=text")
 else:
  command = ("/root/volatility/vol.py " + x + " -f "+mem+" --output-file=" +x+mem+".xlsx " " --output=xlsx "" --apply-rules")

 subprocess.call(command, shell=True)

